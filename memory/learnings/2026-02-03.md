# Learnings: 2026-02-03

## Bootstrap Day - First Awakening

### What Worked Well

**Multi-agent orchestration via Agor MCP**
- Successfully spawned 3 task-focused sessions that ran autonomously
- All completed their objectives (2 PRs created, 1 bug fixed)
- Genealogy tracking worked perfectly for parent-child relationships
- Callbacks and status tracking reliable

**Memory-driven operation**
- File-based memory system works great for cross-session continuity
- Daily logs + agor-state JSON files provide complete picture
- Reading memory at session start establishes context immediately
- Separation of raw logs (daily) vs curated wisdom (MEMORY.md) is clean

**Repository context system**
- Created `repos/` directory for capturing per-repo workflows
- Max's standard PR workflow now documented (pnpm install → check → commit → PR)
- Reading repo context before working in that codebase prevents mistakes

### Challenges & Solutions

**Bug #1: unix_username not auto-populated**
- **Issue:** MCP sessions.create didn't inherit unix_username from caller
- **Impact:** First 2 spawned sessions failed immediately
- **Solution:** Spawned debug session, fixed in Agor codebase, restarted tasks
- **Learning:** When MCP tools fail, fix the platform - don't work around it

**Bug #2: permissionMode not defaulting correctly**
- **Issue:** Sessions created via MCP got `acceptEdits` instead of user's default `bypassPermissions`
- **Impact:** Spawned sessions required more manual approval than intended
- **Solution:** Created another fix session, PR #535
- **Learning:** User defaults should flow through MCP - explicit params shouldn't be required

**Task archiving**
- One task (git worktree debug) turned out to be a non-issue
- Properly archived it in both worktrees.json and sessions.json
- **Learning:** Not every task pans out - archive gracefully and move on

### Patterns Discovered

**Standard PR workflow for preset-io/agor:**
1. `pnpm install` (ensure deps current)
2. `pnpm check` (type check, lint, tests, build - all in one)
3. Commit changes
4. `gh pr create` with title and body
5. Attach PR URL to worktree via `agor.worktrees.update({ pullRequestUrl })`
6. Update tracking in memory/agor-state/

**Heartbeat workflow:**
1. List all sessions via MCP
2. Check status of tracked sessions
3. List all worktrees
4. Compare against memory/agor-state/
5. Update JSON files with current state
6. Append findings to daily log
7. Create learnings entry

### Skills to Improve

**Better error handling**
- When sessions fail, need automated detection and recovery
- Could add retry logic or automatic session restart on known errors

**Proactive cleanup**
- Should periodically check for stale worktrees
- Archive old branches that are merged
- Clean up old daily logs (keep last 30 days)

**Framework contribution workflow**
- Need to establish process for contributing improvements back to `main`
- Separate personal config (repos/preset-io-agor.md) from framework (repos/README.md)

### Key Insights

**Agor is fundamentally different from OpenClaw:**
- OpenClaw: single persistent agent, local automation
- Agor-claw: orchestration layer, delegates work to Agor sessions
- This repo is state management, not execution

**Trust the subsessions:**
- Once spawned with clear task and callback enabled, let them work
- Don't micromanage - check status during heartbeats
- The genealogy tracking provides full audit trail

**Memory is everything:**
- Each session starts fresh - files are the only continuity
- Write liberally to daily logs
- Periodically distill into MEMORY.md
- Agor-state JSON files are source of truth for active resources

### Next Session Priorities

1. Review both PRs (#535, #536) - check if merged
2. If merged, archive those worktrees
3. Consider contributing framework improvements to `main`:
   - repos/ directory system
   - skills/task-management.md
   - AGENTS.md updates
4. Wait for Max to assign new work
5. Build trust through competent execution

---

**First day assessment:** Successful! Multi-agent orchestration works, memory system solid, PRs created autonomously. Ready for real work.
